idle 100
# Good HCW
HCW DIR:0 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x303 msgtype=0 qpri=0 qtype=dir qid=0 dsi=0x302
idle 100
rd hqm_pf_cfg_i.device_status           0x00000010
rd hqm_pf_cfg_i.pcie_cap_device_status  0x00000000
rd hqm_pf_cfg_i.aer_cap_corr_err_status 0x00000000
rd hqm_sif_csr.ri_parity_err            0x00000000
rd hqm_system_csr.alarm_hw_synd         0x00000000
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.msix_31_0_synd        0x00000000
rd hqm_system_csr.msix_ack              0x00000000
rd hqm_system_csr.hqm_system_cnt_0      0x00000001      # Input     HCWs
rd hqm_system_csr.hqm_system_cnt_2      0x00000001      # Output    HCWs
rd hqm_system_csr.hqm_system_cnt_4      0x00000000      # Dropped   HCWs
rd hqm_system_csr.hqm_system_cnt_6      0x00000001      # Scheduled HCWs
rd hqm_system_csr.hqm_system_cnt_8      0x00000001      # SCH->WBUF HCWs
rd hqm_system_csr.hqm_system_cnt_12     0x00000000      # MSIs
rd hqm_system_csr.hqm_system_cnt_14     0x00000000      # MSI-Xs
rd hqm_system_csr.hqm_system_cnt_16     0x00000001      # IOSF writes
##################################################################################################################
idle 100
# Cause a data parity error in the RI TLQ PDATA FIFO
force hqm_tb_top.u_hqm.i_hqm_sip.hqm_sip_aon_wrap.i_hqm_sif.i_hqm_sif_core.i_hqm_ri.i_ri_tlq.tlq_pdata_rxp.data[63] 1
HCW DIR:0 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x303 msgtype=0 qpri=0 qtype=dir qid=0 dsi=0x302 ingress_drop=1
msix_alarm_wait 500
release hqm_tb_top.u_hqm.i_hqm_sip.hqm_sip_aon_wrap.i_hqm_sif.i_hqm_sif_core.i_hqm_ri.i_ri_tlq.tlq_pdata_rxp.data[63]
rd hqm_pf_cfg_i.device_status           0x00008010      # DPE
rd hqm_pf_cfg_i.pcie_cap_device_status  0x00000001      # CED
rd hqm_pf_cfg_i.aer_cap_corr_err_status 0x00002000      # ANFES
rd hqm_sif_csr.ri_parity_err            0x00000008      # PD_FIFO_PERR
rd hqm_sif_csr.sif_alarm_err            0x00000010      # RI_PARITY_ERROR
rd hqm_system_csr.alarm_hw_synd         0x88048400      # v=1 src=2 unit=0 aid=4 cls=2 alarm=1
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.hqm_system_cnt_0      0x00000001      # Input     HCWs
rd hqm_system_csr.hqm_system_cnt_2      0x00000001      # Output    HCWs
rd hqm_system_csr.hqm_system_cnt_4      0x00000000      # Dropped   HCWs
rd hqm_system_csr.hqm_system_cnt_6      0x00000001      # Scheduled HCWs
rd hqm_system_csr.hqm_system_cnt_8      0x00000001      # SCH->WBUF HCWs
rd hqm_system_csr.hqm_system_cnt_12     0x00000000      # MSIs
rd hqm_system_csr.hqm_system_cnt_14     0x00000001      # MSI-Xs
rd hqm_system_csr.hqm_system_cnt_16     0x00000002      # IOSF writes
wr hqm_pf_cfg_i.device_status           0x00008000
rd hqm_pf_cfg_i.device_status           0x00000010
wr hqm_pf_cfg_i.pcie_cap_device_status  0x00000001
rd hqm_pf_cfg_i.pcie_cap_device_status  0x00000000
wr hqm_pf_cfg_i.aer_cap_corr_err_status 0x00002000
rd hqm_pf_cfg_i.aer_cap_corr_err_status 0x00000000
wr hqm_sif_csr.ri_parity_err            0x00000008
rd hqm_sif_csr.ri_parity_err            0x00000000
wr hqm_sif_csr.sif_alarm_err            0x00000010
rd hqm_sif_csr.sif_alarm_err            0x00000000
wr hqm_system_csr.alarm_hw_synd         0x80000000
rd hqm_system_csr.alarm_hw_synd         0x00000000  0x80000000
wr hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_31_0_synd        0x00000000
wr hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.msix_ack              0x00000000
##################################################################################################################
idle 100
# Cause a CBD data parity error
force hqm_tb_top.u_hqm.i_hqm_sip.hqm_sip_aon_wrap.i_hqm_sif.i_hqm_sif_core.i_hqm_ri.i_ri_cds.cbd_wr_data[63] 1
HCW DIR:0 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x303 msgtype=0 qpri=0 qtype=dir qid=0 dsi=0x302 ingress_drop=1
msix_alarm_wait 500
release hqm_tb_top.u_hqm.i_hqm_sip.hqm_sip_aon_wrap.i_hqm_sif.i_hqm_sif_core.i_hqm_ri.i_ri_cds.cbd_wr_data[63]
rd hqm_pf_cfg_i.device_status           0x00008010      # DPE
rd hqm_pf_cfg_i.pcie_cap_device_status  0x00000001      # CED
rd hqm_pf_cfg_i.aer_cap_corr_err_status 0x00002000      # ANFES
rd hqm_sif_csr.ri_parity_err            0x00000080      # CBD_DATA_PERR
rd hqm_sif_csr.sif_alarm_err            0x00000010      # RI_PARITY_ERROR
rd hqm_system_csr.alarm_hw_synd         0x88048400      # v=1 src=2 unit=0 aid=4 cls=2 alarm=1
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.hqm_system_cnt_0      0x00000001      # Input     HCWs
rd hqm_system_csr.hqm_system_cnt_2      0x00000001      # Output    HCWs
rd hqm_system_csr.hqm_system_cnt_4      0x00000000      # Dropped   HCWs
rd hqm_system_csr.hqm_system_cnt_6      0x00000001      # Scheduled HCWs
rd hqm_system_csr.hqm_system_cnt_8      0x00000001      # SCH->WBUF HCWs
rd hqm_system_csr.hqm_system_cnt_12     0x00000000      # MSIs
rd hqm_system_csr.hqm_system_cnt_14     0x00000002      # MSI-Xs
rd hqm_system_csr.hqm_system_cnt_16     0x00000003      # IOSF writes
wr hqm_pf_cfg_i.device_status           0x00008000
rd hqm_pf_cfg_i.device_status           0x00000010
wr hqm_pf_cfg_i.pcie_cap_device_status  0x00000001
rd hqm_pf_cfg_i.pcie_cap_device_status  0x00000000
wr hqm_pf_cfg_i.aer_cap_corr_err_status 0x00002000
rd hqm_pf_cfg_i.aer_cap_corr_err_status 0x00000000
wr hqm_sif_csr.ri_parity_err            0x00000080
rd hqm_sif_csr.ri_parity_err            0x00000000
wr hqm_sif_csr.sif_alarm_err            0x00000010
rd hqm_sif_csr.sif_alarm_err            0x00000000
wr hqm_system_csr.alarm_hw_synd         0x80000000
rd hqm_system_csr.alarm_hw_synd         0x00000000  0x80000000
wr hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_31_0_synd        0x00000000
wr hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.msix_ack              0x00000000
##################################################################################################################
idle 100
# Cause an HCW DB data parity error
# This will also poison the ECC on the HCW, so holding up the hcw_enq in the ingress logic
wr hqm_system_csr.ingress_ctl.enable_debug 1
wr hqm_system_csr.ingress_ctl.hold_hcw_enq 1
idle 100
force hqm_tb_top.u_hqm.i_hqm_sip.hqm_sip_aon_wrap.i_hqm_sif.i_hqm_sif_core.i_hqm_ri.i_ri_cds.hcw_enq_hcw[63] 1
HCW DIR:0 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x303 msgtype=0 qpri=0 qtype=dir qid=0 dsi=0x302 ingress_drop=1
msix_alarm_wait 500
release hqm_tb_top.u_hqm.i_hqm_sip.hqm_sip_aon_wrap.i_hqm_sif.i_hqm_sif_core.i_hqm_ri.i_ri_cds.hcw_enq_hcw[63]
rd hqm_pf_cfg_i.device_status           0x00000010
rd hqm_pf_cfg_i.pcie_cap_device_status  0x00000000
rd hqm_pf_cfg_i.aer_cap_corr_err_status 0x00000000
rd hqm_sif_csr.ri_parity_err            0x00000040      # HCW_DATA_PERR
rd hqm_sif_csr.sif_alarm_err            0x00000010      # RI_PARITY_ERROR
rd hqm_system_csr.alarm_hw_synd         0x88048400      # v=1 src=2 unit=0 aid=4 cls=2 alarm=1
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.hqm_system_cnt_0      0x00000002      # Input     HCWs
rd hqm_system_csr.hqm_system_cnt_2      0x00000001      # Output    HCWs
rd hqm_system_csr.hqm_system_cnt_4      0x00000000      # Dropped   HCWs
rd hqm_system_csr.hqm_system_cnt_6      0x00000001      # Scheduled HCWs
rd hqm_system_csr.hqm_system_cnt_8      0x00000001      # SCH->WBUF HCWs
rd hqm_system_csr.hqm_system_cnt_12     0x00000000      # MSIs
rd hqm_system_csr.hqm_system_cnt_14     0x00000003      # MSI-Xs
rd hqm_system_csr.hqm_system_cnt_16     0x00000004      # IOSF writes
wr hqm_sif_csr.ri_parity_err            0x00000040
rd hqm_sif_csr.ri_parity_err            0x00000000
wr hqm_sif_csr.sif_alarm_err            0x00000010
rd hqm_sif_csr.sif_alarm_err            0x00000000
wr hqm_system_csr.alarm_hw_synd         0x80000000
rd hqm_system_csr.alarm_hw_synd         0x00000000  0x80000000
wr hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_31_0_synd        0x00000000
wr hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.msix_ack              0x00000000
##################################################################################################################
idle 100
# Release the poisoned HCW and this should cause an ingress ECC error drop
wr hqm_system_csr.ingress_ctl.hold_hcw_enq 0
msix_alarm_wait 500
rd hqm_pf_cfg_i.device_status           0x00000010
rd hqm_pf_cfg_i.pcie_cap_device_status  0x00000000
rd hqm_pf_cfg_i.aer_cap_corr_err_status 0x00000000
rd hqm_sif_csr.ri_parity_err            0x00000000
rd hqm_sif_csr.sif_alarm_err            0x00000000
rd hqm_system_csr.alarm_hw_synd         0x806c8500      # v=1 src=0 unit=1 aid=2c cls=2 alarm=1 rtype=1 pp=0
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.alarm_pf_synd0        0x00000000
rd hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.hqm_system_cnt_0      0x00000002      # Input     HCWs
rd hqm_system_csr.hqm_system_cnt_2      0x00000001      # Output    HCWs
rd hqm_system_csr.hqm_system_cnt_4      0x00000001      # Dropped   HCWs
rd hqm_system_csr.hqm_system_cnt_6      0x00000001      # Scheduled HCWs
rd hqm_system_csr.hqm_system_cnt_8      0x00000001      # SCH->WBUF HCWs
rd hqm_system_csr.hqm_system_cnt_12     0x00000000      # MSIs
rd hqm_system_csr.hqm_system_cnt_14     0x00000004      # MSI-Xs
rd hqm_system_csr.hqm_system_cnt_16     0x00000005      # IOSF writes
wr hqm_system_csr.alarm_hw_synd         0x80000000
rd hqm_system_csr.alarm_hw_synd         0x00000000  0x80000000
wr hqm_system_csr.msix_31_0_synd        0x00000001
rd hqm_system_csr.msix_31_0_synd        0x00000000
wr hqm_system_csr.msix_ack              0x00000001
rd hqm_system_csr.msix_ack              0x00000000
##################################################################################################################
HCW DIR:0 qe_valid=0 qe_orsp=0 qe_uhl=0 cq_pop=1 meas=0 lockid=0x000 msgtype=0 qpri=0 qtype=dir qid=0 dsi=0x302

