idle 400
###################################
# Setup FUNC_PF BAR to a base address of 0x00000001_xxxxxxxx
wr hqm_pf_cfg_i.func_bar_l 0x00000000
wr hqm_pf_cfg_i.func_bar_u 0x00000001
###################################
# Setup CSR_PF BAR to a base address of 0x00000002_xxxxxxxx
wr hqm_pf_cfg_i.csr_bar_l 0x00000000
wr hqm_pf_cfg_i.csr_bar_u 0x00000002
###################################
# Enable memory operations
wr hqm_pf_cfg_i.device_command 0x6
rd hqm_pf_cfg_i.device_command

###################################
# Wait for reset to be done (including hardware memory init)
poll config_master.cfg_diagnostic_reset_status 0x000001ff 0x000081ff 1000

###################################
# Setup LUTs used by HCWs

#mem_update      # initialize memories to hqm_cfg defaults using backdoor access

cfg_begin

  ldb qid 0 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 1 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 2 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 3 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 4 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 5 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 6 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 7 qid_ldb_inflight_limit=512 fid_cfg_v=1
  ldb qid 8

  ldb pool 0 credit_cnt=0x3f00 credit_limit=0x4000 freelist_base=0 freelist_limit=0x3fff

  vas 0 ldb_qidv0=1 ldb_qidv1=1 ldb_qidv2=1 ldb_qidv3=1 ldb_qidv4=1 ldb_qidv5=1 ldb_qidv6=1 ldb_qidv7=1

  ldb pp 8  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0x100  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64

  ldb pp 0  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64
  ldb pp 1  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64
  ldb pp 2  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64
  ldb pp 3  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64
  ldb pp 4  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64
  ldb pp 5  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64
  ldb pp 6  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64
  ldb pp 7  gpa=sm vas=0 dir_pool=0 ldb_pool=0 dir_credit_count=0 ldb_credit_count=0  ldb_min_credit_quanta=64 ldb_credit_hwm=256 ldb_credit_lwm=64

  ldb cq 0  gpa=sm cq_depth=64 hist_list_base=0x000 hist_list_limit=0x1ff qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=0 qidv3=1 qidix3=3 pri3=0 qidv4=1 qidix4=4 pri4=0 qidv5=1 qidix5=5 pri5=0 qidv6=1 qidix6=6 pri6=0 qidv7=1 qidix7=7 pri7=7
  ldb cq 1  gpa=sm cq_depth=64 hist_list_base=0x200 hist_list_limit=0x3ff qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=0 qidv3=1 qidix3=3 pri3=0 qidv4=1 qidix4=4 pri4=0 qidv5=1 qidix5=5 pri5=0 qidv6=1 qidix6=6 pri6=0 qidv7=1 qidix7=7 pri7=7
  ldb cq 2  gpa=sm cq_depth=64 hist_list_base=0x400 hist_list_limit=0x5ff qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=2 qidv3=1 qidix3=3 pri3=0 qidv4=1 qidix4=4 pri4=0 qidv5=1 qidix5=5 pri5=0 qidv6=1 qidix6=6 pri6=0 qidv7=1 qidix7=7 pri7=7
  ldb cq 3  gpa=sm cq_depth=64 hist_list_base=0x600 hist_list_limit=0x7ff qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=0 qidv3=1 qidix3=3 pri3=0 qidv4=1 qidix4=4 pri4=0 qidv5=1 qidix5=5 pri5=0 qidv6=1 qidix6=6 pri6=0 qidv7=1 qidix7=7 pri7=7
  ldb cq 4  gpa=sm cq_depth=64 hist_list_base=0x800 hist_list_limit=0x9ff qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=0 qidv3=1 qidix3=3 pri3=0 qidv4=1 qidix4=4 pri4=0 qidv5=1 qidix5=5 pri5=0 qidv6=1 qidix6=6 pri6=0 qidv7=1 qidix7=7 pri7=7
  ldb cq 5  gpa=sm cq_depth=64 hist_list_base=0xa00 hist_list_limit=0xbff qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=0 qidv3=1 qidix3=3 pri3=0 qidv4=1 qidix4=4 pri4=0 qidv5=1 qidix5=5 pri5=0 qidv6=1 qidix6=6 pri6=0 qidv7=1 qidix7=7 pri7=7
  ldb cq 6  gpa=sm cq_depth=64 hist_list_base=0xc00 hist_list_limit=0xdff qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=0 qidv3=1 qidix3=3 pri3=0 qidv4=1 qidix4=4 pri4=4 qidv5=1 qidix5=5 pri5=5 qidv6=1 qidix6=6 pri6=6 qidv7=1 qidix7=7 pri7=7
  ldb cq 7  gpa=sm cq_depth=64 hist_list_base=0xe00 hist_list_limit=0xfef qidv0=1 qidix0=0 pri0=0 qidv1=1 qidix1=1 pri1=0 qidv2=1 qidix2=2 pri2=2 qidv3=1 qidix3=3 pri3=3 qidv4=1 qidix4=4 pri4=4 qidv5=1 qidix5=5 pri5=5 qidv6=1 qidix6=6 pri6=6 qidv7=1 qidix7=7 pri7=7
  ldb cq 8  gpa=sm cq_depth=64 hist_list_base=0xff0 hist_list_limit=0xfff qidv0=1 qidix0=8 pri0=0

cfg_end

rd hqm_pf_cfg_i.vendor_id
