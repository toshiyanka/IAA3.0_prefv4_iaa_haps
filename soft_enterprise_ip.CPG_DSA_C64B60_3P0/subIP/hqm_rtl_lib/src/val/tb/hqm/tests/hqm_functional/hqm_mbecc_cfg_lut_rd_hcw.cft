## Inj MB Ecc Cfg (INJ_MB_ECC_CFG) 
## A rising edge on this bit causes a multi bit ECC error on the next CFG LUT read
## Multi bit ECC error in CSR memory 
## alarm_mb_ecc_err [4] CSR RAM multiple bit ECC error
## alarm_hw_synd: source=0, unit=1,aid=4,cls=2, [12]=  [9:8] rtype=0 [7:0]=lut_addr
##Steve 
##INJ_[SM]B_ECC_CFG allows ECC error injection on the next access of the state stored in the RAM in the hqm_system_cfg block (vf2pf and pf2vf mailboxes).  Operates just like any other error injection (ie. armed for just the next access when rising edge seen on the cfg bit).

#########################################################################################################################
# Inject MB ECC errors
wr hqm_system_csr.ecc_ctl.INJ_MB_ECC_CFG 1
rd hqm_system_csr.ecc_ctl.INJ_MB_ECC_CFG 1
rd hqm_func_pf_per_vf[1].pf_to_vf_mailbox[1]
msix_alarm_wait 500
rd hqm_system_csr.alarm_mb_ecc_err   0x00000010 ##SR RAM MBbit ECC error
rd hqm_system_csr.alarm_hw_synd      0x80448400 0xffffff00  
wr hqm_system_csr.alarm_hw_synd      0x80000000
##clear 
wr hqm_system_csr.alarm_mb_ecc_err   0x00000010
rd hqm_system_csr.alarm_mb_ecc_err   0x00000000
wr hqm_system_csr.msix_ack.MSIX_0_ACK 1
rd hqm_system_csr.msix_ack.MSIX_0_ACK 0

HCW DIR:2  vf_num=0  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=2  dsi=0x300  
HCW DIR:20 vf_num=7  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:20 vf_num=10 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:30 vf_num=15 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=30 dsi=0x300

HCW DIR:2  vf_num=0  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=2  dsi=0x300  
HCW DIR:20 vf_num=7  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:20 vf_num=10 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:30 vf_num=15 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=30 dsi=0x300

HCW DIR:2  vf_num=0  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=2  dsi=0x300  
HCW DIR:20 vf_num=7  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:20 vf_num=10 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:30 vf_num=15 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=30 dsi=0x300

HCW DIR:2  vf_num=0  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=2  dsi=0x300  
HCW DIR:20 vf_num=7  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:20 vf_num=10 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:30 vf_num=15 qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=30 dsi=0x300

poll_sch dir:12  0x4 200 100
poll_sch dir:31  0x4 200 100
poll_sch dir:40  0x4 200 100
poll_sch dir:62  0x4 200 100

idle 1000
## check no further mbecc
rd hqm_system_csr.alarm_mb_ecc_err   0x00000000

## Now reset the sb ecc, send hcw, 
wr hqm_system_csr.ecc_ctl.INJ_MB_ECC_CFG 0
rd hqm_system_csr.ecc_ctl.INJ_MB_ECC_CFG 0
idle 100
rd hqm_func_pf_per_vf[1].pf_to_vf_mailbox[1]

rd hqm_system_csr.alarm_mb_ecc_err   0x00000000

##set sb ecc
wr hqm_system_csr.ecc_ctl.INJ_MB_ECC_CFG 1
rd hqm_system_csr.ecc_ctl.INJ_MB_ECC_CFG 1
rd hqm_func_pf_per_vf[1].vf_to_pf_mailbox[1]
msix_alarm_wait 500
rd hqm_system_csr.alarm_mb_ecc_err   0x00000010 
rd hqm_system_csr.alarm_hw_synd      0x80448400 0xffffff00  
##clear
wr hqm_system_csr.msix_ack.MSIX_0_ACK 1
rd hqm_system_csr.msix_ack.MSIX_0_ACK 0
wr hqm_system_csr.alarm_mb_ecc_err   0x00000010
rd hqm_system_csr.alarm_mb_ecc_err   0x00000000

HCW DIR:6  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=6  dsi=0x300
HCW DIR:6  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=6  dsi=0x300
HCW DIR:6  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=6  dsi=0x300
HCW DIR:6  qe_valid=1 qe_orsp=0 qe_uhl=0 cq_pop=0 meas=0 lockid=0x123 msgtype=0 qpri=0 qtype=dir qid=6  dsi=0x300
poll_sch dir:6  0x4 200 100
##toekn return 
HCW DIR:6  qe_valid=0 qe_orsp=0 qe_uhl=0 cq_pop=1 meas=0 lockid=0x03 msgtype=0 qpri=0 qtype=dir qid=6  dsi=0x300
HCW DIR:2  vf_num=0  qe_valid=0 qe_orsp=0 qe_uhl=0 cq_pop=1 meas=0 lockid=0x003 msgtype=0 qpri=0 qtype=dir qid=2  dsi=0x300  
HCW DIR:20 vf_num=7  qe_valid=0 qe_orsp=0 qe_uhl=0 cq_pop=1 meas=0 lockid=0x003 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:20 vf_num=10 qe_valid=0 qe_orsp=0 qe_uhl=0 cq_pop=1 meas=0 lockid=0x003 msgtype=0 qpri=0 qtype=dir qid=20 dsi=0x300 
HCW DIR:30 vf_num=15 qe_valid=0 qe_orsp=0 qe_uhl=0 cq_pop=1 meas=0 lockid=0x003 msgtype=0 qpri=0 qtype=dir qid=30 dsi=0x300
idle 1000
