rd config_master.cfg_pm_pmcsr_disable
wr config_master.cfg_pm_pmcsr_disable.disable 0
rd config_master.cfg_pm_pmcsr_disable
rd config_master.cfg_pm_override
rd config_master.cfg_diagnostic_reset_status
#poll to Wait for reset to be done 
poll config_master.cfg_diagnostic_reset_status 0x80000bff 0x80000bff 500
#poll to Wait for unit_idle to be done 
poll config_master.cfg_diagnostic_idle_status 0x0007ffff 0x0007ffff 500

###################################
# Wait for reset to be done (including hardware memory init)
poll config_master.cfg_diagnostic_reset_status 0x000001ff 0x000081ff 1000

###################################
# Setup LUTs used by HCWs

#mem_update      # initialize memories to hqm_cfg defaults using backdoor access

cfg_begin

  dir qid DQ0:*
  dir qid DQ1:*
  dir qid DQ2:*
  dir qid DQ3:*
  dir qid DQ4:*
  dir qid DQ5:*
  dir qid DQ6:*
  dir qid DQ7:*

  ldb qid LQ0:* qid_ldb_inflight_limit=256 fid_cfg_v=1
  ldb qid LQ1:* qid_ldb_inflight_limit=256 fid_cfg_v=1
  ldb qid LQ2:* qid_ldb_inflight_limit=256 fid_cfg_v=1
  ldb qid LQ3:* qid_ldb_inflight_limit=256 fid_cfg_v=1
  ldb qid LQ4:* qid_ldb_inflight_limit=256 fid_cfg_v=1
  ldb qid LQ5:* qid_ldb_inflight_limit=256 fid_cfg_v=1
  ldb qid LQ6:* qid_ldb_inflight_limit=256 fid_cfg_v=1
  ldb qid LQ7:* qid_ldb_inflight_limit=256 fid_cfg_v=1

  vas 0 credit_cnt=8192 dir_qidv:DQ0=1 dir_qidv:DQ1=1 dir_qidv:DQ2=1 dir_qidv:DQ3=1 dir_qidv:DQ4=1 dir_qidv:DQ5=1 dir_qidv:DQ6=1 dir_qidv:DQ7=1
  vas 0 ldb_qidv:LQ0=1 ldb_qidv:LQ1=1 ldb_qidv:LQ2=1 ldb_qidv:LQ3=1 ldb_qidv:LQ4=1 ldb_qidv:LQ5=1 ldb_qidv:LQ6=1 ldb_qidv:LQ7=1

  dir pp DQ0  vas=0
  dir pp DQ1  vas=0
  dir pp DQ2  vas=0
  dir pp DQ3  vas=0
  dir pp DQ4  vas=0
  dir pp DQ5  vas=0
  dir pp DQ6  vas=0
  dir pp DQ7  vas=0

  dir cq DQ0  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x000000:0x0fffff]
  dir cq DQ1  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x400000:0x4fffff]
  dir cq DQ2  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x400000:0x4fffff]
  dir cq DQ3  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x400000:0x4fffff]
  dir cq DQ4  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x400000:0x4fffff]
  dir cq DQ5  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x400000:0x4fffff]
  dir cq DQ6  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x400000:0x4fffff]
  dir cq DQ7  cq_depth=1024 gpa=sm cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1 pasid=[0x400000:0x4fffff]

  ldb pp LPP0:*  vas=0
  ldb pp LPP1:*  vas=0
  ldb pp LPP2:*  vas=0
  ldb pp LPP3:*  vas=0
  ldb pp LPP4:*  vas=0
  ldb pp LPP5:*  vas=0
  ldb pp LPP6:*  vas=0
  ldb pp LPP7:*  vas=0

  ldb cq LPP0  cq_depth=1024 gpa=sm hist_list_base=0x000 hist_list_limit=0x0ff qidv0=1 qidix0=LQ0 pri0=0 qidv1=1 qidix1=LQ1 pri1=0 qidv2=1 qidix2=LQ2 pri2=0 qidv3=1 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1
  ldb cq LPP1  cq_depth=1024 gpa=sm hist_list_base=0x100 hist_list_limit=0x1ff qidv0=1 qidix0=LQ0 pri0=0 qidv1=1 qidix1=LQ1 pri1=0 qidv2=1 qidix2=LQ2 pri2=0 qidv3=1 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1
  ldb cq LPP2  cq_depth=1024 gpa=sm hist_list_base=0x200 hist_list_limit=0x2ff qidv0=1 qidix0=LQ0 pri0=0 qidv1=1 qidix1=LQ1 pri1=0 qidv2=1 qidix2=LQ2 pri2=0 qidv3=1 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1
  ldb cq LPP3  cq_depth=1024 gpa=sm hist_list_base=0x300 hist_list_limit=0x3ff qidv0=1 qidix0=LQ0 pri0=0 qidv1=1 qidix1=LQ1 pri1=0 qidv2=1 qidix2=LQ2 pri2=0 qidv3=1 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1
  ldb cq LPP4  cq_depth=1024 gpa=sm hist_list_base=0x400 hist_list_limit=0x4ff qidv0=0 qidix0=LQ0 pri0=0 qidv1=0 qidix1=LQ1 pri1=0 qidv2=0 qidix2=LQ2 pri2=0 qidv3=0 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1
  ldb cq LPP5  cq_depth=1024 gpa=sm hist_list_base=0x500 hist_list_limit=0x5ff qidv0=0 qidix0=LQ0 pri0=0 qidv1=0 qidix1=LQ1 pri1=0 qidv2=0 qidix2=LQ2 pri2=0 qidv3=0 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1
  ldb cq LPP6  cq_depth=1024 gpa=sm hist_list_base=0x600 hist_list_limit=0x6ff qidv0=0 qidix0=LQ0 pri0=0 qidv1=0 qidix1=LQ1 pri1=0 qidv2=0 qidix2=LQ2 pri2=0 qidv3=0 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1
  ldb cq LPP7  cq_depth=1024 gpa=sm hist_list_base=0x700 hist_list_limit=0x7ff qidv0=0 qidix0=LQ0 pri0=0 qidv1=0 qidix1=LQ1 pri1=0 qidv2=0 qidix2=LQ2 pri2=0 qidv3=0 qidix3=LQ3 pri3=0 qidv4=1 qidix4=LQ4 pri4=0 qidv5=1 qidix5=LQ5 pri5=0 qidv6=1 qidix6=LQ6 pri6=0 qidv7=1 qidix7=LQ7 pri7=0 cq_timer_intr_thresh=2 cq_timer_intr_ena=1 cq_depth_intr_thresh=1 cq_depth_intr_ena=1

  vdev 2 dir_pp:DQ0:_v=1 dir_pp:DQ1:_v=1 dir_pp:DQ2:_v=1 dir_pp:DQ3:_v=1 dir_pp:DQ4:_v=1 dir_pp:DQ5:_v=1 dir_pp:DQ6:_v=1 dir_pp:DQ7:_v=1
  vdev 2 dir_vqid0_qid=DQ0 dir_vqid1_qid=DQ1 dir_vqid2_qid=DQ2 dir_vqid3_qid=DQ3 dir_vqid4_qid=DQ4 dir_vqid5_qid=DQ5 dir_vqid6_qid=DQ6 dir_vqid7_qid=DQ7
  vdev 2 ldb_pp0_v=1 ldb_pp1_v=1 ldb_pp2_v=1 ldb_pp3_v=1 ldb_pp4_v=1 ldb_pp5_v=1 ldb_pp6_v=1 ldb_pp7_v=1
  vdev 2 ldb_vqid0_qid=LQ0 ldb_vqid1_qid=LQ1 ldb_vqid2_qid=LQ2 ldb_vqid3_qid=LQ3 ldb_vqid4_qid=LQ4 ldb_vqid5_qid=LQ5 ldb_vqid6_qid=LQ6 ldb_vqid7_qid=LQ7

cfg_end

idle 100

###################################
# Verify expected value of PCIe configuration registers for SCIOV
brd hqm_pf_cfg_i.pcie_cap_device_cap_2.e2etlpps 1
brd hqm_pf_cfg_i.pcie_cap_device_cap_2.effs 1
brd hqm_pf_cfg_i.pasid_control.pasid_enable 1
