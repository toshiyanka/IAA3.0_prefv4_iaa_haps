idle 400
###################################
# Read first part of PF header
rd hqm_pf_cfg_i.vendor_id
rd hqm_pf_cfg_i.device_id
rd hqm_pf_cfg_i.device_command
rd hqm_pf_cfg_i.device_status
###################################
# Setup FUNC_PF BAR to a base address of 0x00000001_xxxxxxxx
wr hqm_pf_cfg_i.func_bar_l 0x00000000
wr hqm_pf_cfg_i.func_bar_u 0x00000001
###################################
# Setup CSR_PF BAR to a base address of 0x00000002_xxxxxxxx
wr hqm_pf_cfg_i.csr_bar_l 0x00000000
wr hqm_pf_cfg_i.csr_bar_u 0x00000002
###################################
# Enable memory operations
wr hqm_pf_cfg_i.device_command 0x6
rd hqm_pf_cfg_i.device_command
###################################
# Test hqm_system LUTs
rd hqm_system_csr.vf_dir_vpp_v[0]
wr hqm_system_csr.vf_dir_vpp_v[0] 0x1
rd hqm_system_csr.vf_dir_vpp_v[0] 0x1
wr hqm_system_csr.vf_dir_vpp_v[0] 0x0
rd hqm_system_csr.vf_dir_vpp_v[0] 0x0
###################################
# Test hqm_core registers
rd credit_hist_pipe.cfg_dir_pp_dir_credit_count[0]
wr credit_hist_pipe.cfg_dir_pp_dir_credit_count[0] 0x1234
rd credit_hist_pipe.cfg_dir_pp_dir_credit_count[0] 0x1234
###################################
# Setup LUTs used by HCWs

cfg_begin

ldb qid  0  ord_mode=0 ord_slot=0 ord_grp=0 
dir qid  1
ldb qid  1
ldb qid  4  ord_mode=0 ord_slot=0 ord_grp=0 
dir qid  5
ldb qid  5
ldb qid  8  ord_mode=0 ord_slot=0 ord_grp=0 
dir qid  9
ldb qid  9
ldb qid 12  ord_mode=0 ord_slot=0 ord_grp=0 
dir qid 13
ldb qid 13

dir pool 0 credit_cnt=0xf00 credit_limit=0x1000 freelist_base=0 freelist_limit=0xfff
ldb pool 0 credit_cnt=0x4000 credit_limit=0x4000 freelist_base=0 freelist_limit=0x3fff

dir pp  0 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  1 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  2 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  3 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  4 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  5 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  6 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  7 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  8 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp  9 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp 10 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp 11 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp 12 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp 13 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp 14 dir_pool=0 ldb_pool=0 dir_credit_count=0x10
dir pp 15 dir_pool=0 ldb_pool=0 dir_credit_count=0x10

ldb cq  1 cq_depth=1024 hist_list_base=0x0000 hist_list_limit=0x00ff qidv0=1 qidix0=0 pri0=0
ldb cq  2 cq_depth=1024 hist_list_base=0x0100 hist_list_limit=0x01ff qidv0=1 qidix0=0 pri0=0
ldb cq  3 cq_depth=1024 hist_list_base=0x0200 hist_list_limit=0x02ff qidv0=1 qidix0=0 pri0=0

ldb cq  5 cq_depth=1024 hist_list_base=0x0300 hist_list_limit=0x03ff qidv0=1 qidix0=4 pri0=1
ldb cq  6 cq_depth=1024 hist_list_base=0x0400 hist_list_limit=0x04ff qidv0=1 qidix0=4 pri0=1
ldb cq  7 cq_depth=1024 hist_list_base=0x0500 hist_list_limit=0x05ff qidv0=1 qidix0=4 pri0=1

ldb cq  9 cq_depth=1024 hist_list_base=0x0600 hist_list_limit=0x06ff qidv0=1 qidix0=8 pri0=2
ldb cq 10 cq_depth=1024 hist_list_base=0x0700 hist_list_limit=0x07ff qidv0=1 qidix0=8 pri0=2
ldb cq 11 cq_depth=1024 hist_list_base=0x0800 hist_list_limit=0x08ff qidv0=1 qidix0=8 pri0=2

ldb cq 13 cq_depth=1024 hist_list_base=0x0900 hist_list_limit=0x09ff qidv0=1 qidix0=12 pri0=3
ldb cq 14 cq_depth=1024 hist_list_base=0x0a00 hist_list_limit=0x0aff qidv0=1 qidix0=12 pri0=3
ldb cq 15 cq_depth=1024 hist_list_base=0x0b00 hist_list_limit=0x0bff qidv0=1 qidix0=12 pri0=3

ldb cq 16 cq_depth=1024 hist_list_base=0x0c00 hist_list_limit=0x0cff qidv0=1 qidix0=1  pri0=0
ldb cq 17 cq_depth=1024 hist_list_base=0x0d00 hist_list_limit=0x0dff qidv0=1 qidix0=5  pri0=0
ldb cq 18 cq_depth=1024 hist_list_base=0x0e00 hist_list_limit=0x0eff qidv0=1 qidix0=9  pri0=0
ldb cq 19 cq_depth=1024 hist_list_base=0x0f00 hist_list_limit=0x0fff qidv0=1 qidix0=13 pri0=0

cfg_end

###################################
# Wait for reset to be done (including hardware memory init)
poll config_master.cfg_diagnostic_reset_status 0x000001ff 0x000081ff 1000
